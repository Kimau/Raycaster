#include "algebra.h"


vec4 createPlaneFromPoints(const vec3& a, const vec3& b, const vec3& c) {
	vec3 norm = ((a - b)*(b - c));
	norm.Normalize();
	return vec4(norm.x, norm.y, norm.z, -norm.Dot(a));
}

vec4 createPlaneFromPointNormal(const vec3& pt, const vec3& norm) { return vec4(norm.x, norm.y, norm.z, -norm.Dot(pt)); }
float distanceFromPlane(const vec3& pt, const vec4& plane) { return -plane.xyz().Dot(pt) - plane.w; }



vec2 poisson_disc8[8] = {
	{ 0.0f, 0.0f },
{ -0.7448162913978268f, -0.6605358602020448f },
{ 0.6793847032530552f, 0.7274432794893779f },
{ -0.6823184596478814f, 0.6943347987856568f },
{ 0.41994767541460704f, -0.8629451296473639f },
{ 0.9306200954352646f, -0.10103953727772876f },
{ -0.98912722229778f, 0.011114529580331808f },
{ -0.0002526422308083288f, 0.9148077901806102f }
};
float poisson_disc8_len[8] = { 
	1.0f,
	0.004480572492697288f,
	0.004642124716691121f,
	0.026522063331183565f,
	0.0402967402013068f,
	0.06391092831865708f,
	0.010810334335060845f,
	0.08519217493332065f 
};

vec2 poisson_disc50[50] = {
	{ 0.0f, 0.0f },
{ 0.7329949588024661f, -0.6775807606734287f },
{ 0.8798704072641732f, 0.4466313494160853f },
{ -0.7428906278131927f, -0.6555508089209141f },
{ -0.912096291575766f, 0.39874955191272166f },
{ 0.03526514612848765f, 0.9189522994383396f },
{ -0.0219651302692083f, -0.9209451706383288f },
{ 0.30750409016017594f, 0.4432049994127126f },
{ 0.5387000896535721f, -0.12375240800609547f },
{ -0.43229613997777355f, 0.6460966714559817f },
{ -0.8204963870629199f, -0.12928421824108796f },
{ -0.2590011858477525f, -0.4480502313359615f },
{ 0.2582326728529389f, -0.5010262409835633f },
{ -0.4798110009090263f, 0.1931785905302342f },
{ 0.464184016645606f, 0.8405499957153727f },
{ 0.9145704396840713f, -0.1409957592502245f },
{ -0.3910282618364465f, -0.8957246184350487f },
{ -0.10941125216757658f, 0.48352287284316753f },
{ -0.4099809298286512f, -0.14237399893844233f },
{ 0.7352487486186121f, 0.13952406154953204f },
{ 0.40296076592965385f, -0.8902065043137225f },
{ 0.40955628481111556f, 0.1573952770862995f },
{ -0.2793973454315308f, 0.9514934844064716f },
{ 0.6566221085263173f, 0.6358162525528087f },
{ -0.8859293698860671f, -0.4022924610177481f },
{ -0.5953966919167117f, -0.4196449493222492f },
{ -0.8007128724547223f, 0.15267954382189358f },
{ -0.7339328472803951f, 0.6733211315471809f },
{ 0.6272996779608886f, -0.3949402525286675f },
{ 0.14273343489893722f, -0.23677492958725666f },
{ -0.19346828859011017f, 0.19485657766700476f },
{ -0.6060572405985678f, 0.4386998632240844f },
{ 0.18576988761698585f, -0.7654921399299127f },
{ -0.004971106682846057f, -0.6068652877665719f },
{ -0.47143333360145495f, -0.6476268808925223f },
{ -0.16982967492336648f, -0.20821397694807622f },
{ 0.15653303044288794f, 0.2485235351364745f },
{ 0.9192253712398785f, -0.37582433693035083f },
{ 0.635167502619638f, 0.38096375532464744f },
{ 0.2301739448124533f, 0.7378107368166835f },
{ 0.30904843709455837f, -0.06625695888960396f },
{ -0.17982837201467025f, 0.7413888641238606f },
{ -0.33649428200294f, 0.4003100084093579f },
{ 0.9707234977843885f, 0.09367767793540457f },
{ 0.42227679394037526f, -0.649010167507185f },
{ -0.5970832037711836f, -0.03719103838610167f },
{ 0.19352602167884445f, -0.9719360913576651f },
{ -0.03334014251746722f, -0.3838447006561573f },
{ -0.15881957333344207f, -0.7546952292625781f },
{ 0.4575256711726871f, 0.5825438981909945f }
};
float poisson_disc50_len[50] = {
	1.0f,
	0.0018029769306006083f,
	0.013262194977584185f,
	0.009225884487516267f,
	0.0045499257838890195f,
	0.08037129276295685f,
	0.07879292541263883f,
	0.4605656323799343f,
	0.4472681978752501f,
	0.22261923003834116f,
	0.16938051415253075f,
	0.48247645070900336f,
	0.4363410539316416f,
	0.4827606313972519f,
	0.03979632545674916f,
	0.07462499857059968f,
	0.022643517632667476f,
	0.5042528964649546f,
	0.5660014765037915f,
	0.2516299804932638f,
	0.02283829424139272f,
	0.5612408135692695f,
	0.008333358682387382f,
	0.08598966066250435f,
	0.027009726349517815f,
	0.27157766080587775f,
	0.18486065779134797f,
	0.0039986091851659245f,
	0.25872900431944446f,
	0.7235308322450775f,
	0.7254110990041958f,
	0.251826925855534f,
	0.2122889695835759f,
	0.39311435228895353f,
	0.19895695191509344f,
	0.7313083948443675f,
	0.7062883435470009f,
	0.006914296064921555f,
	0.25934411549281167f,
	0.22711920179596667f,
	0.6839289303465312f,
	0.2371135790772555f,
	0.4770501891640324f,
	0.024766891202863683f,
	0.2257055545670843f,
	0.4017596423159857f,
	0.008984315588064895f,
	0.6147100840601976f,
	0.22877464645830525f,
	0.25926581481507305f 
};

vec3 poisson_sphere8[8] = {
	{0.0f, 0.0f, 0.0f},
	{ -0.5918071351843124f, -0.796609317921307f, -0.08956146173466403f },
	{ -0.6248119055573628f, -0.08974784709505822f, 0.7659065603684194f },
	{ 0.981762873353016f, 0.1335652052707851f, -0.037899362564916106f },
	{ 0.4945633252354818f, -0.6655900666317727f, -0.5411927154173042f },
	{ -0.19485476843481536f, 0.73675296491881f, -0.6468878607275821f },
	{ 0.3828503987105521f, 0.8569225899826023f, 0.336531657919541f },
	{ 0.2744573387389939f, -0.8148013086801911f, 0.5023783089493365f }
};

vec3 poisson_sphere50[50] = {
	{ 0.0f, 0.0f, 0.0f},
	{ -0.8869957232066299f, 0.2645535116706493f, 0.3734063307578524f },
	{ 0.15036568143087117f, -0.4167648780122423f, -0.8841614438142607f },
	{ -0.05964472948702857f, -0.9600575721254107f, 0.27287640533574303f },
	{ -0.01589723604539946f, 0.6261902204497063f, -0.7742833153397078f },
	{ -0.030616248548929588f, 0.187155770520018f, 0.9817477622861295f },
	{ 0.9666210750306955f, 0.09665717172737366f, 0.18669469271644495f },
	{ -0.7376751750849829f, -0.27251743586495586f, -0.5157158082343872f },
	{ 0.30761367070234125f, 0.7615417965412257f, 0.31779132772156365f },
	{ 0.5034205464600147f, -0.5346838950504895f, -0.1901326234169004f },
	{ 0.3785158443709f, -0.43326730288447785f, 0.7379407242804593f },
	{ -0.40213117104129525f, -0.44035285220988263f, 0.7849039281938708f },
	{ -0.4483624665161051f, 0.8547462456164778f, -0.1424911448973398f },
	{ -0.697737910256278f, -0.5715650855655182f, 0.15308726825289423f },
	{ 0.7092253013083637f, 0.35953277839048126f, -0.5752643446521787f },
	{ -0.9096152505229027f, 0.27768525395008997f, -0.2798008030228361f },
	{ -0.2563327059450429f, 0.644556044217074f, 0.41583095870415643f },
	{ -0.2092670263459496f, -0.7209890741274464f, -0.3532105247322791f },
	{ 0.44238955662429263f, -0.12450858299188175f, 0.29675835272856893f },
	{ -0.33879048399381273f, 0.08017891641721193f, -0.9060761872675369f },
	{ 0.605219919267334f, 0.2103388841919515f, 0.6990097684754524f },
	{ -0.32124600189594144f, 0.306427778822446f, -0.3957614633009575f },
	{ 0.30359854834703204f, 0.02977312985635253f, -0.47950684175310043f },
	{ 0.1416919798965174f, 0.759087490789923f, -0.24487157532482548f },
	{ -0.19080088252929242f, -0.472108531356791f, 0.10417327097407912f },
	{ 0.16060866041003652f, 0.13016184344810777f, -0.9406403817107466f },
	{ 0.8914089067142305f, -0.1457165129285321f, -0.3242826834838996f },
	{ -0.48034075209874005f, -0.05761813351482868f, 0.23553580789739328f },
	{ 0.7501668824521494f, 0.5986579238881276f, -0.12541556838665877f },
	{ -0.0642671410723738f, -0.008880422640429745f, 0.49861737757254826f },
	{ -0.2737868945499481f, -0.22198734620757138f, -0.39784282442294644f },
	{ -0.524280786553817f, 0.12107077738547976f, 0.6817981532133583f },
	{ 0.8885105530463472f, -0.3979355102359655f, 0.17975647062107702f },
	{ 0.45553582461445324f, 0.2279034635377708f, -0.03555515166142994f },
	{ -0.357007219272455f, -0.6996781319065265f, 0.418425513119126f },
	{ 0.3612332228482085f, -0.7228000035260038f, 0.20094862210292422f },
	{ -0.7554030661327266f, 0.5683761211655525f, 0.01152502774408778f },
	{ 0.10148973937635618f, 0.6514280245899973f, 0.7362104793357275f },
	{ -0.30946878306720244f, -0.40750040025369516f, -0.808605855161414f },
	{ -0.08770965247432078f, 0.5107338627395237f, 0.06584823036560726f },
	{ 0.18085621171940738f, -0.8749688153588937f, -0.16050211191194766f },
	{ -0.7744461501684007f, -0.2740354571284123f, 0.5200330076128897f },
	{ -0.8760089097465641f, -0.24624465833373343f, -0.0791610149281576f },
	{ 0.7369617459959604f, -0.1974980923780174f, 0.5881404730052484f },
	{ 0.6563323224507172f, 0.4823372050409619f, 0.37737628790398575f },
	{ 0.22118282069817122f, -0.6970416985748938f, -0.525385832730441f },
	{ 0.14901237734308237f, 0.32386285174573254f, 0.3937448181278467f },
	{ -0.011345427344657934f, -0.6902156395452786f, 0.7038292694292345f },
	{ 0.3300156870963395f, 0.47860333355683143f, -0.5165589861589323f },
	{ -0.5554265817665232f, -0.5358643858543394f, -0.2368479699848905f },
};


vec2 poissonDisc8(int i) { return poisson_disc8[i];  }
vec3 poissonSphere8(int i) { return poisson_sphere8[i]; }
vec2 poissonDisc50(int i) { return poisson_disc50[i]; }
vec3 poissonSphere50(int i) { return poisson_sphere50[i]; }
